<!doctype html>
<html lang="en-GB">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Open Roles — Emirates Group Roblox</title>
<meta name="description" content="Open roles at Emirates Group Roblox."/>
<style>
:root{--bg:#041018;--panel:#071425;--text:#e6eef8;--muted:#9aa4b2;--brand:#c8102e}
*{box-sizing:border-box}body{margin:0;font-family:Inter,system-ui,Roboto,Arial;background:linear-gradient(180deg,#031018,#041018);color:var(--text)}
.header{background:linear-gradient(90deg,rgba(0,0,0,0.25),rgba(0,0,0,0.15));padding:12px;position:sticky;top:0;z-index:60;border-bottom:1px solid rgba(255,255,255,0.02)}
.header .inner{max-width:1180px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;padding:8px 18px}
.header a{color:var(--text);text-decoration:none;margin-left:12px;font-weight:700}
.container{max-width:1180px;margin:28px auto;padding:0 18px}
.controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px}
.input{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text);flex:1}
.select{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)}
.jobs-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:12px}
.job-card{padding:16px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.005));border:1px solid rgba(255,255,255,0.02)}
.job-title{font-weight:900;font-size:18px}
.job-meta{color:var(--muted);margin-top:6px}
.actions{margin-top:12px;display:flex;gap:8px}
.btn-primary{background:var(--brand);color:white;padding:8px 12px;border-radius:8px;border:0;cursor:pointer}
.btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--text);padding:8px 12px;border-radius:8px}
.muted{color:var(--muted)}
.footer{padding:28px 0;border-top:1px solid rgba(255,255,255,0.02);margin-top:28px;text-align:center;color:var(--muted)}
@media(max-width:880px){ .controls{flex-direction:column} }
</style>
</head>
<body>
  <header class="header">
    <div class="inner">
      <div style="display:flex;align-items:center;gap:12px"><img src="logo.png" alt="logo" height="36"><strong>Emirates Group Roblox</strong></div>
      <nav>
        <a href="index.html">Home</a>
        <a href="jobs.html">Openings</a>
        <a href="employee-rights.html">Employee Rights</a>
        <a href="terms.html">Terms</a>
        <a href="hr-login.html" class="btn-ghost">HR Login</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
      <div>
        <h1 style="margin:0">Current opportunities</h1>
        <p class="muted">Browse open roles and apply online. If no roles appear, HR has not posted jobs yet.</p>
      </div>
      <div><a class="btn-primary" href="apply.html">Apply</a></div>
    </section>

    <section style="margin-top:18px">
      <div class="controls">
        <input id="q" class="input" placeholder="Search jobs, keywords, division..." />
        <select id="status" class="select">
          <option value="">All statuses</option><option>Open</option><option>Closed</option><option>Draft</option>
        </select>
        <select id="division" class="select">
          <option value="">All divisions</option><option>Flight Operations</option><option>Customer Service</option><option>Ground Operations</option><option>HR & Recruitment</option><option>IT & Systems</option>
        </select>
        <button id="searchBtn" class="btn-primary">Search</button>
      </div>

      <div id="jobsGrid" class="jobs-grid" aria-live="polite">
        <div class="job-card"><div class="job-title">No roles currently posted</div><div class="muted" style="margin-top:8px">HR has not created any job listings yet. Please check Discord for announcements.</div></div>
      </div>
    </section>
  </main>

  <footer class="footer">© 2025 Emirates Group Roblox — Careers • <a href="https://discord.gg/nDAZ3p475V" target="_blank">Discord</a></footer>

<script>
const API_URL = 'https://script.google.com/macros/s/AKfycbzTwLSlOIXxDGVICcIlytL1PSbsaoBlf-TrUZLAYNWei1rqcEIot2O-Wk48QQamKUfq/exec';

async function fetchJobs(q='', status='', division=''){
  try{
    const url = new URL(API_URL);
    url.searchParams.set('path','getJobs');
    if(q) url.searchParams.set('q', q);
    if(status) url.searchParams.set('status', status);
    const res = await fetch(url.toString());
    const j = await res.json();
    return j.jobs || [];
  }catch(e){ console.warn(e); return []; }
}

function renderJobs(jobs){
  const grid = document.getElementById('jobsGrid');
  if(!jobs || jobs.length===0){
    grid.innerHTML = '<div class="job-card"><div class="job-title">No roles currently posted</div><div class="muted" style="margin-top:8px">HR has not created any job listings yet. Please check Discord for announcements.</div></div>';
    return;
  }
  grid.innerHTML = jobs.map(job => `
    <div class="job-card">
      <div class="job-title">${escapeHtml(job.title)}</div>
      <div class="job-meta">${escapeHtml(job.division || '')} • ${escapeHtml(job.location || '')} • <strong>${escapeHtml(job.status || '')}</strong></div>
      <div class="muted" style="margin-top:8px">${escapeHtml(job.summary || '')}</div>
      <div class="actions">
        <a class="btn-primary" href="apply.html?job=${encodeURIComponent(job.job_id)}">Apply</a>
        <a class="btn-ghost" href="jobs.html?job=${encodeURIComponent(job.job_id)}">View</a>
      </div>
    </div>
  `).join('');
}

function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

document.getElementById('searchBtn').addEventListener('click', async ()=>{
  const q = document.getElementById('q').value.trim();
  const status = document.getElementById('status').value;
  const division = document.getElementById('division').value;
  const jobs = await fetchJobs(q, status, division);
  renderJobs(jobs);
});

// Initial load
(async ()=>{ const jobs = await fetchJobs(); renderJobs(jobs); })();
</script>
</body>
</html>
