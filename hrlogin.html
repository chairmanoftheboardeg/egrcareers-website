<!doctype html>
<html lang="en-GB">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>HR Login — Emirates Group Roblox</title>
<style>
:root{--bg:#031018;--panel:rgba(255,255,255,0.05);--text:#e8f1f8;--brand:#c8102e}
body{margin:0;background:linear-gradient(180deg,#031018,#04121a);font-family:Inter,Arial;color:var(--text);display:flex;align-items:center;justify-content:center;min-height:100vh}
.card{background:var(--panel);padding:32px;border-radius:14px;max-width:420px;width:100%;border:1px solid rgba(255,255,255,0.08)}
h1{margin-top:0;text-align:center}
label{display:block;margin-top:12px;font-size:14px;color:#9aa4b2}
input{width:100%;padding:10px;margin-top:6px;border-radius:8px;border:1px solid rgba(255,255,255,0.08);background:transparent;color:var(--text)}
button{margin-top:18px;width:100%;padding:10px;border:0;border-radius:8px;background:var(--brand);color:white;font-weight:700;cursor:pointer}
#msg{margin-top:12px;font-size:13px;color:#aaa;text-align:center}
</style>
</head>
<body>
<div class="card">
  <h1>HR Access Login</h1>
  <label>Email</label>
  <input id="email" placeholder="you@example.com" type="email" required>
  <label>Password</label>
  <input id="password" type="password" placeholder="********" required>
  <button id="loginBtn">Sign in</button>
  <div id="msg"></div>
</div>

<script>
const API_URL = 'https://script.google.com/macros/s/AKfycbzgsKI-ob7TGzjl_pDecy5Pt0rVpppFKlk6E_mIuHfWoIETeqMkwPXfTdgqEcmXmldJBQ/exec';

document.getElementById('loginBtn').addEventListener('click', async ()=>{
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value.trim();
  if(!email || !password){ document.getElementById('msg').textContent = "Please fill in both fields."; return; }

  document.getElementById('msg').textContent = "Signing in…";

  try {
    const res = await fetch(API_URL, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ action:'loginHR', email, password })
    });
    const data = await res.json();

    if(data.ok){
      // Save both modern and legacy keys
      localStorage.setItem('hrLoggedIn','true');
      localStorage.setItem('hrEmail',data.email);
      localStorage.setItem('hrName',data.name);
      localStorage.setItem('hrRole',data.role);

      sessionStorage.setItem('egr_hr_email',data.email);
      sessionStorage.setItem('egr_hr_name',data.name);
      sessionStorage.setItem('egr_hr_role',data.role);

      document.getElementById('msg').textContent = "Login successful. Redirecting…";
      setTimeout(()=> location.href='hrdashboard.html', 800);
    } else {
      document.getElementById('msg').textContent = "Invalid login credentials.";
    }
  } catch(err){
    console.error(err);
    document.getElementById('msg').textContent = "Network or server error.";
  }
});
</script>
</body>
</html>
