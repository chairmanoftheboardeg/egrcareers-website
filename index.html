<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>EGR Careers — Join the Future</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="theme-color" content="#0f1629"/>
  <link rel="stylesheet" href="/css/careers.css?v=6"/>
  <style>
    /* --- visual upgrades for energy --- */
    .hero{position:relative;overflow:hidden}
    .hero .container{padding:56px 0}
    .title{font-size:clamp(28px,5.8vw,56px)}
    .eyebrow{letter-spacing:.18em;text-transform:uppercase;font-size:.8rem;color:#9fb0d1}
    .glow{animation:shine 3.5s ease-in-out infinite;background:linear-gradient(90deg,#fff,#d9e6ff,#fff);-webkit-background-clip:text;background-clip:text;color:transparent}
    @keyframes shine{0%,100%{filter:drop-shadow(0 0 0 rgba(158,196,255,.0))}50%{filter:drop-shadow(0 0 18px rgba(158,196,255,.35))}}
    #fx{position:absolute;inset:0;z-index:-3}
    .orbs{position:absolute;inset:0;z-index:-2;pointer-events:none}
    .orb{position:absolute;border-radius:50%;filter:blur(12px) saturate(120%);opacity:.5}
    .orb.a{width:280px;height:280px;background:radial-gradient(circle at 30% 30%,#7eb2ff,transparent 60%);top:-40px;right:8%;animation:float 16s ease-in-out infinite}
    .orb.b{width:220px;height:220px;background:radial-gradient(circle at 30% 30%,#ff2d55,transparent 60%);bottom:-20px;left:12%;animation:float 20s ease-in-out infinite}
    .orb.c{width:180px;height:180px;background:radial-gradient(circle at 30% 30%,#6bffb3,transparent 60%);top:30%;left:38%;animation:float 22s ease-in-out infinite}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-14px)}}

    .band{border-top:1px solid var(--line);border-bottom:1px solid var(--line);padding:12px 0;margin-top:-1px;background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.03));backdrop-filter:blur(6px)}
    .band-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    @media (max-width:900px){.band-grid{grid-template-columns:1fr}}
    .time-tile{display:grid;gap:6px;place-items:center;background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px}
    .time{font:700 28px/1.1 ui-monospace, SFMono-Regular, Menlo, Consolas, monospace}
    .mini{font-size:12px;color:#a9b8d6}
    .grid.four{grid-template-columns:repeat(4,1fr)}
    @media (max-width:900px){.grid.four{grid-template-columns:1fr 1fr}}
    .stat-neo{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.04));border:1px solid var(--line);border-radius:16px;padding:18px;text-align:center;transition:transform .2s ease, box-shadow .2s ease}
    .stat-neo:hover{transform:translateY(-2px);box-shadow:0 18px 46px rgba(0,0,0,.28)}
    .kpi{font-size:34px;font-weight:900;letter-spacing:.5px}
    .under{position:relative;display:inline-block}
    .under::after{content:"";position:absolute;left:0;right:0;bottom:-6px;height:2px;background:linear-gradient(90deg,transparent,#9ec4ff,transparent);opacity:.7}
    .ticker{margin-top:10px}
    .neon{border:1px solid rgba(158,196,255,.25); background:rgba(158,196,255,.08); padding:10px 12px; border-radius:12px; box-shadow:0 0 28px rgba(158,196,255,.15) inset}
    .carousel{display:grid;grid-auto-flow:column;grid-auto-columns:calc(25% - 12px);gap:16px;overflow:auto;scroll-snap-type:x mandatory;padding-bottom:6px}
    @media (max-width:900px){.carousel{grid-auto-columns:80%}}
    .slide{scroll-snap-align:start;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.04));border:1px solid var(--line);border-radius:14px;padding:14px;display:grid;gap:6px;min-height:120px}
    .skel{background:linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.1), rgba(255,255,255,.06));background-size:200% 100%;animation:sweep 1.2s ease-in-out infinite;border-radius:12px}
    @keyframes sweep{0%{background-position:200% 0}100%{background-position:-200% 0}}

    /* photo mosaic to make page feel alive */
    .mosaic{display:grid;grid-template-columns:2fr 1fr 1fr;gap:12px}
    .mosaic img{width:100%;height:100%;object-fit:cover;border-radius:14px;border:1px solid var(--line);background:#0a0f1f}
    @media (max-width:900px){.mosaic{grid-template-columns:1fr 1fr}}

  </style>
  <link rel="preconnect" href="https://unpkg.com">
  <script defer src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script defer src="/js/supabaseClient.js?v=6"></script>
</head>
<body>
  <!-- NAV -->
  <header class="nav">
    <div class="container">
      <a class="brand" href="/"><span class="plane">✈</span><strong>EGR Careers</strong></a>
      <nav class="links">
        <a href="/jobs.html">Jobs</a>
        <a href="/dashboard.html">My Applications</a>
        <a href="/hr.html">HR Portal</a>
        <div class="clock" id="clock">--:--</div>
        <button id="authBtn" class="btn" onclick="document.getElementById('authModal').showModal()">Sign In</button>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section
    class="hero"
    data-hero-path=""
    data-hero-images="EGR Headquarters Pic.png, meeting room hq.png, occ office.png, occ.png, office 1.png, office hq.png"
    id="hero"
  >
    <canvas id="fx"></canvas>
    <div class="orbs"><div class="orb a"></div><div class="orb b"></div><div class="orb c"></div></div>
    <img id="heroImg" alt="" style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:-1;filter:brightness(.78)">
    <div class="container hero-inner">
      <div>
        <div class="eyebrow">Hello Tomorrow</div>
        <h1 class="title glow">Join the Future of Virtual Aviation</h1>
        <p class="sub">Roles across Emirates Airlines, Fly Dubai, EGR HQ, University, and Falcon LTD.</p>
        <div class="ticker neon" id="systemTicker">System ready.</div>
        <div class="row" style="margin-top:14px">
          <a class="btn primary" href="/jobs.html">Browse Open Roles</a>
          <a class="btn ghost" href="https://emiratesgrouproblox.link/" target="_blank" rel="noopener">Main Site</a>
        </div>
      </div>
    </div>
  </section>

  <!-- LIVE PHOTOS (MOSAIC using your images) -->
  <section class="container" style="margin-top:18px">
    <div class="card">
      <h2 class="under">Inside EGR</h2>
      <div class="mosaic" id="mosaic">
        <!-- We’ll populate via JS with your 6 image names -->
      </div>
    </div>
  </section>

  <!-- TIME STRIP -->
  <section class="band">
    <div class="container band-grid">
      <div class="time-tile"><div class="mini">Your Local Time</div><div class="time" id="timeLocal">--:--</div></div>
      <div class="time-tile"><div class="mini">Dubai (GST)</div><div class="time" id="timeDubai">--:--</div></div>
      <div class="time-tile"><div class="mini">Open Roles</div><div class="time" id="openRolesCount">—</div></div>
    </div>
  </section>

  <!-- EGR IN NUMBERS -->
  <section class="container" style="margin-top:24px">
    <div class="card">
      <h2 class="under">EGR in numbers</h2>
      <div class="grid four">
        <div class="stat-neo"><div class="kpi" data-count="2023">0</div><div class="label">Founded</div></div>
        <div class="stat-neo"><div class="kpi" id="kpiOpen" data-count="0">0</div><div class="label">Open roles right now</div></div>
        <div class="stat-neo"><div class="kpi" data-count="6">0</div><div class="label">Departments</div></div>
        <div class="stat-neo"><div class="kpi" data-count="4">0</div><div class="label">Divisions/Subsidiary</div></div>
      </div>
    </div>
  </section>

  <!-- LATEST ROLES -->
  <section class="container" style="margin-top:24px">
    <div class="card">
      <div class="row" style="justify-content:space-between;align-items:center">
        <h2 class="under">Latest roles</h2>
        <a class="btn" href="/jobs.html">View all</a>
      </div>
      <div class="carousel" id="latestRoles">
        <div class="slide skel" style="height:120px"></div>
        <div class="slide skel" style="height:120px"></div>
        <div class="slide skel" style="height:120px"></div>
        <div class="slide skel" style="height:120px"></div>
      </div>
    </div>
  </section>

  <!-- FOCUS & BENEFITS -->
  <section class="container" style="margin-top:24px">
    <div class="grid two">
      <div class="card">
        <h2 class="under">Focus areas</h2>
        <div class="grid two">
          <div class="item"><strong>Safety & Wellbeing</strong><p class="meta">High standards in training & event safety.</p></div>
          <div class="item"><strong>Learning & Growth</strong><p class="meta">University & on-the-job coaching.</p></div>
          <div class="item"><strong>Operational Excellence</strong><p class="meta">Realistic procedures & consistent quality.</p></div>
          <div class="item"><strong>Community & Culture</strong><p class="meta">Teamwork and professionalism first.</p></div>
        </div>
      </div>
      <div class="card">
        <h2 class="under">Benefits</h2>
        <div class="grid two">
          <div class="item"><strong>Pathways</strong><p class="meta">Clear progressions to senior roles.</p></div>
          <div class="item"><strong>Recognition</strong><p class="meta">Badges, features & role progression.</p></div>
          <div class="item"><strong>Flexibility</strong><p class="meta">Schedules that fit school & life.</p></div>
          <div class="item"><strong>Tools & SOPs</strong><p class="meta">Modern tools & guides to excel.</p></div>
        </div>
      </div>
    </div>
  </section>

  <!-- HIRING PROCESS -->
  <section class="container" style="margin-top:24px">
    <div class="card">
      <h2 class="under">How we hire</h2>
      <div class="list">
        <div class="item"><strong>1) Apply online</strong><div class="meta">Create an account and submit your application.</div></div>
        <div class="item"><strong>2) Review & shortlist</strong><div class="meta">HR screens for fit and may request a quick chat.</div></div>
        <div class="item"><strong>3) Tryouts / interview</strong><div class="meta">Some roles include scenarios or tryouts.</div></div>
        <div class="item"><strong>4) Offer & onboarding</strong><div class="meta">Tools, SOPs & training—then you’re ready to fly.</div></div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container foot-grid">
      <div>© 2025 Emirates Group Roblox — Careers</div>
      <div class="links">
        <a href="/">Home</a>
        <a href="/jobs.html">Jobs</a>
        <a href="https://emiratesgrouproblox.link/terms.html" target="_blank" rel="noopener">Website Terms</a>
        <a href="https://emiratesgrouproblox.link/privacy.html" target="_blank" rel="noopener">Privacy</a>
      </div>
    </div>
  </footer>

  <!-- AUTH (basic) -->
  <dialog id="authModal" class="modal">
    <form method="dialog" class="card" onsubmit="return false;">
      <h3>Sign in / Create account</h3>
      <input type="email" id="authEmail" placeholder="Email address" required />
      <input type="password" id="authPass" placeholder="Password" required />
      <div class="row">
        <button class="btn" id="loginBtn">Sign In</button>
        <button class="btn ghost" id="signupBtn">Create Account</button>
        <button class="btn red" onclick="document.getElementById('authModal').close()">Close</button>
      </div>
      <p id="authMsg" class="meta"></p>
    </form>
  </dialog>

  <!-- JS: clocks, rotator, counters, carousel, particles, mosaic -->
  <script>
    const hasSupabase = !!(window.supabase && typeof window.supabase.from === 'function');

    function fmtDubaiFallback(){ const now=new Date(); const utc=now.getTime()+now.getTimezoneOffset()*60000; const dubai=new Date(utc+4*3600*1000); return dubai.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'}); }
    function startClocks(){
      const elLocal=document.getElementById('timeLocal'); const elDubai=document.getElementById('timeDubai');
      const tick=()=>{
        if(elLocal) elLocal.textContent=new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
        try{ const d=new Intl.DateTimeFormat([], {hour:'2-digit',minute:'2-digit',timeZone:'Asia/Dubai'}).format(new Date()); if(elDubai) elDubai.textContent=d; }
        catch(e){ if(elDubai) elDubai.textContent=fmtDubaiFallback(); }
      }; tick(); setInterval(tick,15000);
    }

    // Robust hero rotator: only uses URLs that actually load (filters bad names)
    async function startHeroRotator(){
      const section=document.getElementById('hero'); const imgEl=document.getElementById('heroImg'); if(!section||!imgEl) return;
      const base=section.getAttribute('data-hero-path')||''; 
      const names=(section.getAttribute('data-hero-images')||'').split(',').map(s=>s.trim()).filter(Boolean);
      if(!names.length) return;
      const urls=names.map(n=>`${base}${n.split('/').map(encodeURIComponent).join('/')}?v=${Date.now()}`);

      // test-load all, keep only successes
      const ok=[];
      await Promise.all(urls.map(u=>new Promise(res=>{
        const p=new Image();
        p.onload=()=>{ ok.push(u); res(); };
        p.onerror=()=>{ console.warn('Image not found:', u); res(); };
        p.src=u;
      })));
      if(!ok.length){ console.error('No hero images loaded'); return; }

      let i=0; imgEl.src=ok[0];
      setInterval(()=>{ i=(i+1)%ok.length; imgEl.src=ok[i]; }, 7000);
    }

    function animateCounters(){
      const counters=[...document.querySelectorAll('.kpi')];
      const io=new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(!e.isIntersecting) return;
          const el=e.target; const target=parseInt(el.getAttribute('data-count')||'0',10);
          const t0=performance.now(), dur=1200;
          const step=(t)=>{ const p=Math.min(1,(t-t0)/dur); const v=Math.floor(target*(0.5-Math.cos(p*Math.PI)/2)); el.textContent=v; if(p<1) requestAnimationFrame(step); };
          requestAnimationFrame(step); io.unobserve(el);
        });
      },{threshold:.4});
      counters.forEach(el=>io.observe(el));
    }

    async function loadLatestRoles(){
      const wrap=document.getElementById('latestRoles'); if(!wrap) return;
      if(!hasSupabase){ wrap.innerHTML='<div class="slide">Connect Supabase to list live roles.</div>'; return; }
      const { data:jobs, error }=await supabase.from('jobs').select('id,title,division,posted_at,status,is_paid').eq('status','open').order('posted_at',{ascending:false}).limit(8);
      if(error){ wrap.innerHTML=`<div class="slide">Load failed: ${error.message}</div>`; return; }
      if(!jobs?.length){ wrap.innerHTML='<div class="slide">No open roles right now.</div>'; return; }
      wrap.innerHTML=jobs.map(j=>`
        <article class="slide">
          <div class="row"><span class="badge status-open">open</span><span class="badge">${j.is_paid?'paid':'unpaid'}</span></div>
          <h3 style="margin:.2rem 0">${j.title}</h3>
          <div class="meta">${j.division||'EGR'} · Posted ${j.posted_at}</div>
          <div class="row"><a class="btn" href="/job.html?id=${j.id}">View</a><a class="btn primary" href="/apply.html?id=${j.id}">Apply</a></div>
        </article>
      `).join('');
      const oc=document.getElementById('openRolesCount'); if(oc) oc.textContent=jobs.length;
      const kpi=document.getElementById('kpiOpen'); if(kpi) kpi.setAttribute('data-count', String(jobs.length));
    }

    function startSystemTicker(){
      const el=document.getElementById('systemTicker'); if(!el) return;
      const msgs=[
        "System nominal · Recruiting across all divisions · Hello Tomorrow",
        "Tip: Create an account to track your application status in real time",
        "Dubai HQ online · OCC monitoring schedules · Safety first",
        "Careers at EGR: Operations · Cabin · Ground · IT · University"
      ];
      let i=0; el.textContent=msgs[0]; setInterval(()=>{ i=(i+1)%msgs.length; el.textContent=msgs[i]; },6000);
    }

    function startParticles(){
      const c=document.getElementById('fx'); if(!c) return; const ctx=c.getContext('2d'); let w=0,h=0,dots=[];
      const R=1.2,N=70; function resize(){ w=c.width=window.innerWidth; h=c.height=document.getElementById('hero').offsetHeight; }
      function init(){ dots=Array.from({length:N},()=>({x:Math.random()*w,y:Math.random()*h,vx:(Math.random()-.5)*R,vy:(Math.random()-.5)*R})); }
      function step(){ ctx.clearRect(0,0,w,h); ctx.globalAlpha=.8; for(const d of dots){ d.x+=d.vx; d.y+=d.vy; if(d.x<0||d.x>w) d.vx*=-1; if(d.y<0||d.y>h) d.vy*=-1; ctx.fillStyle='rgba(158,196,255,0.12)'; ctx.beginPath(); ctx.arc(d.x,d.y,1.1,0,6.283); ctx.fill(); } requestAnimationFrame(step); }
      resize(); init(); step(); window.addEventListener('resize',()=>{ resize(); init(); });
    }

    // Photo mosaic using your 6 images (shows even if rotator fails)
    function mountMosaic(){
      const names=[
        "EGR Headquarters Pic.png","meeting room hq.png","occ office.png","occ.png","office 1.png","office hq.png"
      ];
      const m=document.getElementById('mosaic'); if(!m) return;
      m.innerHTML = names.map(n=>{
        const url = n.split('/').map(encodeURIComponent).join('/');
        return `<img src="${url}" alt="">`;
      }).join('');
    }

    // Basic auth modal (optional)
    function wireAuth(){
      if(!hasSupabase) return;
      const email=document.getElementById('authEmail'); const pass=document.getElementById('authPass'); const msg=document.getElementById('authMsg');
      document.getElementById('loginBtn')?.addEventListener('click', async ()=>{
        const { error } = await supabase.auth.signInWithPassword({ email: email.value.trim(), password: pass.value.trim() });
        msg.textContent = error ? error.message : 'Signed in — reload to continue';
      });
      document.getElementById('signupBtn')?.addEventListener('click', async ()=>{
        const { error } = await supabase.auth.signUp({ email: email.value.trim(), password: pass.value.trim() });
        msg.textContent = error ? error.message : 'Account created — Sign In now';
      });
    }

    (async function boot(){
      startClocks();
      startHeroRotator();
      startParticles();
      startSystemTicker();
      animateCounters();
      mountMosaic();
      if(hasSupabase){ await loadLatestRoles(); } else {
        const oc=document.getElementById('openRolesCount'); if(oc) oc.textContent='—';
        const kpi=document.getElementById('kpiOpen'); if(kpi) kpi.setAttribute('data-count','0');
        document.getElementById('latestRoles').innerHTML='<div class="slide">Connect Supabase to show live roles.</div>';
      }
      wireAuth();
    })();
  </script>
</body>
</html>
